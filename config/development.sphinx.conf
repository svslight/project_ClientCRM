
indexer
{
}

searchd
{
  listen = 127.0.0.1:9306:mysql41
  log = /home/svs/project_ClientCRM/log/development.searchd.log
  query_log = /home/svs/project_ClientCRM/log/development.searchd.query.log
  pid_file = /home/svs/project_ClientCRM/log/development.sphinx.pid
  workers = threads
  binlog_path = /home/svs/project_ClientCRM/tmp/binlog/development
}

source client_core_0
{
  type = pgsql
  sql_host = 127.0.0.1
  sql_user = crm_dev
  sql_pass = dev
  sql_db = crm_dev
  sql_port = 5433
  sql_query_pre = SET TIME ZONE UTC
  sql_query = SELECT "clients"."id" * 6 + 0 AS "id", "clients"."surname" AS "surname", "clients"."name" AS "name", "clients"."patronymic" AS "patronymic", "clients"."birthdate" AS "birthdate", "countries"."name" AS "country", "groups"."name" AS "group_name", "groups"."city" AS "group_city", "clients"."id" AS "sphinx_internal_id", 'Client' AS "sphinx_internal_class", 0 AS "sphinx_deleted", "clients"."country_id" AS "country_id", "clients"."group_id" AS "group_id", "clients"."group_position_id" AS "group_position_id", "clients"."team_position_id" AS "team_position_id", extract(epoch from "clients"."created_at")::int AS "created_at", extract(epoch from "clients"."updated_at")::int AS "updated_at" FROM "clients" LEFT OUTER JOIN "countries" ON "countries"."id" = "clients"."country_id" LEFT OUTER JOIN "groups" ON "groups"."id" = "clients"."group_id" WHERE ("clients"."id" BETWEEN $start AND $end) GROUP BY "clients"."id", "clients"."surname", "clients"."name", "clients"."patronymic", "clients"."birthdate", "countries"."name", "groups"."name", "groups"."city", "clients"."id", "clients"."country_id", "clients"."group_id", "clients"."group_position_id", "clients"."team_position_id", "clients"."created_at", "clients"."updated_at"
  sql_query_range = SELECT COALESCE(MIN("clients"."id"), 1), COALESCE(MAX("clients"."id"), 1) FROM "clients"
  sql_attr_uint = sphinx_deleted
  sql_attr_uint = created_at
  sql_attr_uint = updated_at
  sql_attr_bigint = sphinx_internal_id
  sql_attr_bigint = country_id
  sql_attr_bigint = group_id
  sql_attr_bigint = group_position_id
  sql_attr_bigint = team_position_id
  sql_attr_string = sphinx_internal_class
  sql_field_string = surname
  sql_field_string = country
  sql_field_string = group_name
  sql_field_string = group_city
}

index client_core
{
  type = plain
  path = /home/svs/project_ClientCRM/db/sphinx/development/client_core
  source = client_core_0
}

source group_core_0
{
  type = pgsql
  sql_host = 127.0.0.1
  sql_user = crm_dev
  sql_pass = dev
  sql_db = crm_dev
  sql_port = 5433
  sql_query_pre = SET TIME ZONE UTC
  sql_query = SELECT "groups"."id" * 6 + 1 AS "id", "groups"."name" AS "name", "groups"."city" AS "city", "group_statuses"."name" AS "group_status", "groups"."id" AS "sphinx_internal_id", 'Group' AS "sphinx_internal_class", 0 AS "sphinx_deleted", "groups"."country_id" AS "country_id", "groups"."group_status_id" AS "group_status_id", extract(epoch from "groups"."created_at")::int AS "created_at", extract(epoch from "groups"."updated_at")::int AS "updated_at" FROM "groups" LEFT OUTER JOIN "group_statuses" ON "group_statuses"."id" = "groups"."group_status_id" WHERE ("groups"."id" BETWEEN $start AND $end) GROUP BY "groups"."id", "groups"."name", "groups"."city", "group_statuses"."name", "groups"."id", "groups"."country_id", "groups"."group_status_id", "groups"."created_at", "groups"."updated_at"
  sql_query_range = SELECT COALESCE(MIN("groups"."id"), 1), COALESCE(MAX("groups"."id"), 1) FROM "groups"
  sql_attr_uint = sphinx_deleted
  sql_attr_uint = created_at
  sql_attr_uint = updated_at
  sql_attr_bigint = sphinx_internal_id
  sql_attr_bigint = country_id
  sql_attr_bigint = group_status_id
  sql_attr_string = sphinx_internal_class
  sql_field_string = name
  sql_field_string = group_status
}

index group_core
{
  type = plain
  path = /home/svs/project_ClientCRM/db/sphinx/development/group_core
  source = group_core_0
}

source user_core_0
{
  type = pgsql
  sql_host = 127.0.0.1
  sql_user = crm_dev
  sql_pass = dev
  sql_db = crm_dev
  sql_port = 5433
  sql_query_pre = SET TIME ZONE UTC
  sql_query = SELECT "users"."id" * 6 + 2 AS "id", "users"."email" AS "email", "users"."first_name" AS "first_name", "users"."last_name" AS "last_name", "clients"."city" AS "client_city", "clients"."address" AS "client_address", "users"."id" AS "sphinx_internal_id", 'User' AS "sphinx_internal_class", 0 AS "sphinx_deleted", "users"."client_id" AS "client_id", extract(epoch from "users"."created_at")::int AS "created_at", extract(epoch from "users"."updated_at")::int AS "updated_at" FROM "users" LEFT OUTER JOIN "clients" ON "clients"."id" = "users"."client_id" WHERE ("users"."id" BETWEEN $start AND $end) GROUP BY "users"."id", "users"."email", "users"."first_name", "users"."last_name", "clients"."city", "clients"."address", "users"."id", "users"."client_id", "users"."created_at", "users"."updated_at"
  sql_query_range = SELECT COALESCE(MIN("users"."id"), 1), COALESCE(MAX("users"."id"), 1) FROM "users"
  sql_attr_uint = sphinx_deleted
  sql_attr_uint = created_at
  sql_attr_uint = updated_at
  sql_attr_bigint = sphinx_internal_id
  sql_attr_bigint = client_id
  sql_attr_string = sphinx_internal_class
  sql_field_string = email
  sql_field_string = client_city
  sql_field_string = client_address
}

index user_core
{
  type = plain
  path = /home/svs/project_ClientCRM/db/sphinx/development/user_core
  source = user_core_0
}

index client
{
  type = distributed
  local = client_core
}

index group
{
  type = distributed
  local = group_core
}

index user
{
  type = distributed
  local = user_core
}
